<!-- Copyright 2014, Digium, Inc.--><!-- All rights reserved.--><!----><!-- This source code is licensed under The MIT License found in the--><!-- LICENSE file in the root directory of this source tree.--><!----><!-- For all details and documentation:  https://www.respoke.io--><!DOCTYPE html><html><head><title>lib/client.js - respoke</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><link rel="stylesheet" href="https://highlightjs.org/static/styles/github.css"><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,300" rel="stylesheet" type="text/css"><style type="text/css">html, body {
    font-family: 'Open Sans', sans-serif;
}
h1, h2, h3 {
    color: #f76;
}
h4, h5 {
    font-weight: 600;
}
a {
    color: #57adff !important;
}
pre {
    box-shadow: inset 1px 1px 2px #4a4a4a;
    background: #f4f4f4;
    border: none;
}
pre code {
    background: #f4f4f4 !important;
}
code {
    word-wrap: break-word;
}
.container {
    max-width: 750px;
}</style><script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script src="https://highlightjs.org/static/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="container">
<div id="respoke" class="comment"><div><h1 id="-respoke-https-www-respoke-io-for-node"><a href="https://www.respoke.io">Respoke</a> for Node</h1>
<p><a href="http://badge.fury.io/js/respoke-admin"><img src="https://badge.fury.io/js/respoke-admin.svg" alt="NPM version"></a>
<a href="https://travis-ci.org/respoke/node-respoke-admin"><img src="https://travis-ci.org/respoke/node-respoke-admin.svg" alt="Build Status"></a>
<a href="https://david-dm.org/respoke/node-respoke-admin"><img src="https://david-dm.org/respoke/node-respoke-admin.svg" alt="Dependency Status"></a>
<a href="https://david-dm.org/respoke/node-respoke-admin#info=devDependencies"><img src="https://david-dm.org/respoke/node-respoke-admin/dev-status.svg" alt="devDependency Status"></a></p>
<h2 id="setup">Setup</h2>
<p>Install using npm.</p>
<pre><code class="lang-bash">npm install --save respoke-admin
</code></pre>
<p>For more details on the node-respoke API see the
<a href="https://respoke.github.io/node-respoke-admin" title="node-respoke-admin documentation">project documentation</a>. For more on the Respoke service and
how it works see the <a href="https://docs.respoke.io" title="full respoke documentation">full documentation</a>.</p>
<h2 id="debugging">Debugging</h2>
<p>This library uses the <code>debug</code> npm module. To enable debugging output, use the following
environment variable:</p>
<pre><code class="lang-bash">DEBUG=respoke-client
</code></pre>
<h2 id="error-handling">Error handling</h2>
<p>A respoke <code>client</code> inherits from <code>EventEmitter</code>.</p>
<pre><code class="lang-javascript">client.on(&#39;error&#39;, function (err) { console.error(err); });
</code></pre>
<p>If you fail to listen for the error event, <strong>errors will be thrown</strong> so they are not
buried.</p>
<h2 id="testing">Testing</h2>
<p>Before you can run the functional tests you will need to complete the following
steps.</p>
<ul>
<li>create a test app in the your admin portal at [respoke.io][respoke]</li>
<li>turn <em>off</em> dev mode</li>
<li>create a new blank role (name value is not important)</li>
<li><code>cp spec/helpers.example.js spec/helpers.js</code></li>
<li>fill in the information in the <code>spec/helpers.js</code> file</li>
</ul>
<p>There are several commands to run the tests.</p>
<pre><code class="lang-bash"># run all tests
npm test

# run all tests with extra debug output
npm run debug-test

# run only unit tests
npm run unit

# run only functional tests
npm run functional
</code></pre>
<h4 id="building-and-viewing-the-source-documentation">Building and viewing the source documentation</h4>
<pre><code class="lang-bash">npm run docs
</code></pre>
<hr>
<h2 id="respoke-authentication">Respoke Authentication</h2>
<p>There are multiple levels of authentication to Respoke, depending on your use case.
In general, the hierarchy of credentials is as follows:</p>
<blockquote>
<ol>
<li><p>&quot;Admin-Token&quot; (full account administrator)</p>
</li>
<li><p>&quot;App-Secret&quot; (app level administration)</p>
</li>
<li><p>&quot;App-Token&quot; (endpoint / end user)</p>
</li>
</ol>
</blockquote>
<hr>
<h2 id="examples">Examples</h2>
<h3 id="instantiate-a-client-with-an-app-secret-">Instantiate a client with an <code>App-Secret</code></h3>
<pre><code> var Respoke = require(&#39;respoke-admin&#39;);
 var admin = new Respoke({
     // from the Respoke developer console under one of your apps
     appId: &quot;XXXX-XXX-XXXXX-XXXX&quot;,
     &#39;App-Secret&#39;: &#39;XXXX-XXXXX-XXX-XXXXXXXX&#39;,
     // if the respoke socket is lost, keep trying to reconnect automatically
     autoreconnect: true
 });

 // connect to respoke
 // provide an `endpointId` for receiving messages
 admin.auth.connect({ endpointId: &quot;superWombat&quot;});
 admin.on(&#39;connect&#39;, function () {
     console.log(&#39;admin is connected to respoke&#39;);
 });
 admin.on(&#39;message&#39;, function (message) {
     if (message.endpointId === &#39;billy&#39;) {
         console.log(&#39;message from billy&#39;, message);
     }
 });
</code></pre><h3 id="obtain-a-session-token-for-an-endpoint">Obtain a session token for an endpoint</h3>
<pre><code> admin.auth.endpoint({
     endpointId: &quot;billy&quot;,
     roleId: &quot;XXXX-XXX-XXXXX-XXXX&quot;
 }, function (err, authData) {
     if (err) { console.error(err); return; }

     // Now we have a token for an end user to authenticate as an endpoint.
     console.log(authData.tokenId); // &quot;XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX&quot;
     var billy = new Respoke({ appId: &#39;XXXX-XXXXX-XXXX-XXX&#39; });

     billy.auth.sessionToken({ tokenId: authData.tokenId }, function (err, sessionData) {
         if (err) { console.error(err); return; }

         // Now we have a session token from `sessionData.token`.
         // However, for our purposes, there is no need to do anything with it because
         // the library caches it automatically at `billy.tokens[&#39;App-Token&#39;]`, and
         // uses it when it needs it.
         billy.auth.connect();

         // Respoke is an EventEmitter
         billy.on(&#39;connect&#39;, function () {
             console.log(&#39;connected to respoke!&#39;);
             billy.messages.send({
                 to: &#39;superWombat&#39;,
                 message: &#39;Hi wombat&#39;
             });
         });

     });
 });
</code></pre><hr>
</div><br><h2>Constructor</h2><h4><code>new Respoke(options)</code></h4><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>options</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">Optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options.appId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options['Admin-Token']</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional header, if you already authenticated</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options['App-Secret']</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional header, from Respoke dev console</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options['App-Token']</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional header, if you already authenticated</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options.endpointId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional endpointId to use when connecting via web socket
using auth scheme which does not imply an endpointId (i.e. App-Secret)</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options.autoreconnect=false</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">Optional flag to automatically reconnect to
respoke if a web socket connection becomes active, then is lost. This will throw an error
when attempting to reconnect if specified without an App-Secret.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options.baseURL=https://api.respoke.io/v1</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>options.socket</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">Optional, overrides the default socket.io client</div></div><br class="visible-xs"><br><br><h2>Properties and Methods</h2><br>
</div><div id="tokens" class="comment"><h4><code>object</code><a href="#tokens" class="bold"> respoke.tokens</a></h4><div><p>Container object for header tokens.
These are used when performing REST or web socket requests to Respoke.</p>
</div><br><br><br>
</div><div id="tokens['Admin-Token']" class="comment"><h4><code>string</code><a href="#tokens['Admin-Token']" class="bold"> respoke.tokens['Admin-Token']</a></h4><div><p>Header <code>Admin-Token</code></p>
</div><br><br><br>
</div><div id="tokens['App-Secret']" class="comment"><h4><code>string</code><a href="#tokens['App-Secret']" class="bold"> respoke.tokens['App-Secret']</a></h4><div><p>Header <code>App-Secret</code></p>
</div><br><br><br>
</div><div id="tokens['App-Token']" class="comment"><h4><code>string</code><a href="#tokens['App-Token']" class="bold"> respoke.tokens['App-Token']</a></h4><div><p>Header <code>App-Token</code></p>
</div><br><br><br>
</div><div id="appId" class="comment"><h4><code>string</code><a href="#appId" class="bold"> respoke.appId</a></h4><div><p>App id</p>
</div><br><br><br>
</div><div id="connectionId" class="comment"><h4><code>string</code><a href="#connectionId" class="bold"> respoke.connectionId</a></h4><div><p>If connected, this is the web socket connection ID with Respoke.</p>
</div><br><br><br>
</div><div id="endpointId" class="comment"><h4><code>string</code><a href="#endpointId" class="bold"> respoke.endpointId</a></h4><div><p>If connected, this is the endpointId. Stored endpointId for use when connecting
with App-Secret via web socket (when not a specific endpoint).</p>
</div><br><br><br>
</div><div id="baseURL" class="comment"><h4><code>string</code><a href="#baseURL" class="bold"> respoke.baseURL</a></h4><div><p>The base respoke api to use. In most circumstances there is no reason
to change this.</p>
<p>It should include the API version with no trailing <code>/</code>.</p>
<p><code>https://api.respoke.io/v1</code></p>
</div><br><br><br>
</div><div id="socket" class="comment"><h4><code>SocketObject</code><a href="#socket" class="bold"> respoke.socket</a></h4><div><p>The web socket connection instance from socket.io. It is recommended that
you do not access this directly.</p>
</div><br><br><br>
</div><div id="request" class="comment"><h4><a href="#request"><span class="bold"> respoke.request(params, callback)</span></a></h4><div><p>General purpose method for doing a REST call to Respoke.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.body</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.json=true</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.headers=self.tokens</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">(err, body)</div></div><br class="visible-xs"><br><br><br>
</div><div id="wsCall" class="comment"><h4><a href="#wsCall"><span class="bold"> respoke.wsCall(httpMethod, urlPath, data)</span></a></h4><div><p>Make a general purpose web socket call over the active <code>.socket</code>.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>httpMethod</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>urlPath</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Relative to `baseUrl`</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>data</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">Optional; to be sent over web socket</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[data.headers]</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">Optional WS header object</div></div><br class="visible-xs"><br><br><br>
</div><div id="auth" class="comment"><h4><code>object</code><a href="#auth" class="bold"> respoke.auth</a></h4><div><p>Namespace object. The methods at <code>respoke.auth</code> are used for
obtaining auth credentials and connecting with Respoke.</p>
</div><br><br><br>
</div><div id="auth-endpoint" class="comment"><h4><a href="#auth.endpoint"><span class="bold"> respoke.auth.endpoint(opts, callback)</span></a></h4><div><p>As an admin (with <code>respoke.tokens[&#39;App-Token&#39;]</code> or <code>respoke.tokens[&#39;App-Secret&#39;]</code>),
obtain a <code>tokenId</code> which can be used to authenticate to Respoke as an endpoint.</p>
<pre><code> respoke.auth.endpoint({
     endpointId: &quot;user-billy&quot;,
     roleId: &quot;XXXX-XXX-XXXXX-XXXX&quot;
 }, function (err, authData) {
     if (err) { console.error(err); return; }

     console.log(authData.tokenId); // &quot;XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX&quot;
 });
</code></pre></div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>opts</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.appId</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.endpointId</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.roleId</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">required unless app is in development mode</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.ttl=86400</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional seconds time-to-live</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.headers['App-Secret']</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional; override cached token</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.headers['Admin-Token']</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional; override cached token</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">(err, clientAuthData)</div></div><br class="visible-xs"><br><br><br>
</div><div id="auth-sessionToken" class="comment"><h4><a href="#auth.sessionToken"><span class="bold"> respoke.auth.sessionToken(opts, callback)</span></a></h4><div><p>As an endpoint, obtain an app auth session. This creates a session for the user
to connect to your Respoke app.</p>
<p>Upon successful authentication, it sets the property <code>respoke.tokens[&#39;App-Token&#39;]</code>
which will be used during HTTP requests, or to establish a web socket.
<code>{ token: &#39;XXXX-XXX-XXXXX-XXXX&#39; }</code></p>
<p>In most cases, you will immediately call <code>.connect()</code> to initiate the web socket.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>opts</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[opts.tokenId]</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">(err, body)</div></div><br class="visible-xs"><br><br><br>
</div><div id="auth-connect" class="comment"><h4><a href="#auth.connect"><span class="bold"> respoke.auth.connect(opts)</span></a></h4><div><p>Connect as a web socket client using the highest authentication token
currently available.</p>
<p>After calling this, attach event listeners such as
<code>respoke.on(&#39;connect&#39;)</code> and <code>respoke.on(&#39;error&#39;)</code>.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>opts</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.endpointId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">required if not connecting using App-Token</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts['Admin-Token']</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts['App-Secret']</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts['App-Token']</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.connectParams</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional Socket.io connection parameters</div></div><br class="visible-xs"><br><br><br>
</div><div id="auth-admin" class="comment"><h4><a href="#auth.admin"><span class="bold"> respoke.auth.admin(opts, callback)</span></a></h4><div><p>Authenticate with full admin privileges. This is not a recommended auth strategy
and should only be used in rare circustances when <code>App-Secret</code> auth is not
enough.</p>
<p>Upon successful authentication, it sets the property <code>respoke.tokens[&#39;Admin-Token&#39;]</code>
which will be used during HTTP requests or to establish a web socket.
<code>{ token: &#39;XXXX-XXX-XXXXX-XX&#39; }</code></p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>opts</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">Required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.username</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts.password</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">(err, body)</div></div><br class="visible-xs"><br><br><br>
</div><div id="close" class="comment"><h4><a href="#close"><span class="bold"> respoke.close(callback)</span></a></h4><div><p>Delete the app auth session, disconnect the web socket, and remove all listeners.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">(err)</div></div><br class="visible-xs"><br><br><br>
</div><div id="presence" class="comment"><h4><code>object</code><a href="#presence" class="bold"> respoke.presence</a></h4><div><p>Namespace object. Methods for interacting with presence indication.</p>
</div><br><br><br>
</div><div id="presence-observe" class="comment"><h4><a href="#presence.observe"><span class="bold"> respoke.presence.observe(endpoints, callback)</span></a></h4><div><p>Register as an observer of presence for the specified endpoint ids.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>endpoints</code></div><div class="col-sm-3"><strong>array&lt;string&gt;</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><div id="presence-set" class="comment"><h4><a href="#presence.set"><span class="bold"> respoke.presence.set(params, callback)</span></a></h4><div><p>Set your own presence.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.presence</code></div><div class="col-sm-3"><strong>string, number, object, array</strong></div><div class="col-sm-5">Your presence object. Format varies,
depending on how your application decides to implement presence.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.status</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Human readable status message.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><div id="messages" class="comment"><h4><code>object</code><a href="#messages" class="bold"> respoke.messages</a></h4><div><p>Namespace object. Messaging.</p>
</div><br><br><br>
</div><div id="messages-send" class="comment"><h4><a href="#messages.send"><span class="bold"> respoke.messages.send(params, callback)</span></a></h4><div><p>Send a message to an endpoint or specific connection of an endpoint.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.to</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">endpointId</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.connectionId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.message</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.type='message'</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.ccSelf=true</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.endpointId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><div id="groups" class="comment"><h4><code>object</code><a href="#groups" class="bold"> respoke.groups</a></h4><div><p>Namespace object. Groups.</p>
</div><br><br><br>
</div><div id="groups-publish" class="comment"><h4><a href="#groups.publish"><span class="bold"> respoke.groups.publish(params, callback)</span></a></h4><div><p>Send a message to a group. When authenticated as an admin via <code>App-Secret</code>
or <code>Admin-Token</code>, you can pass messages for any <code>endpointId</code>.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.groupId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.message</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.endpointId=self.endpointId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><div id="groups-getSubscribers" class="comment"><h4><a href="#groups.getSubscribers"><span class="bold"> respoke.groups.getSubscribers(params, callback)</span></a></h4><div><p>Get the members of a group.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.groupId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><div id="groups-join" class="comment"><h4><a href="#groups.join"><span class="bold"> respoke.groups.join(params, callback)</span></a></h4><div><p>Join a group.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.groupId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><div id="groups-leave" class="comment"><h4><a href="#groups.leave"><span class="bold"> respoke.groups.leave(params, callback)</span></a></h4><div><p>Leave a group.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.groupId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.endpointId</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><div id="apps" class="comment"><h4><code>object</code><a href="#apps" class="bold"> respoke.apps</a></h4><div><p>Namespace object. For full admin only.</p>
</div><br><br><br>
</div><div id="apps-get" class="comment"><h4><a href="#apps.get"><span class="bold"> respoke.apps.get(opts, callback)</span></a></h4><div><p>Get an app by <code>opts.appId</code>, or get all apps when <code>opts.appId</code> is not supplied.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>opts</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[opts.appId]</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[opts.headers]</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">(err, app)</div></div><br class="visible-xs"><br><br><br>
</div><div id="roles" class="comment"><h4><code>object</code><a href="#roles" class="bold"> respoke.roles</a></h4><div><p>Namespace object. For full admin only.</p>
</div><br><br><br>
</div><div id="roles-get" class="comment"><h4><a href="#roles.get"><span class="bold"> respoke.roles.get(options, callback(err,)</span></a></h4><div><p>Retrieve a security role</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>options</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[options.appId]</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[options.roleId]</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback(err,</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">role)</div></div><br class="visible-xs"><br><br><br>
</div><div id="roles-create" class="comment"><h4><a href="#roles.create"><span class="bold"> respoke.roles.create(role, opts, callback(err,)</span></a></h4><div><p>Create a security role.</p>
<p>The callback data object contains the <code>id</code> of the created role,
which can be used for authenticating endpoints.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>role</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">the role to create required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[role.appId]</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[role.name]</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>opts</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional request opts</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[opts.headers]</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback(err,</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5">createdRole)</div></div><br class="visible-xs"><br><br><br>
</div><div id="roles-delete" class="comment"><h4><a href="#roles.delete"><span class="bold"> respoke.roles.delete(opts, callback(err))</span></a></h4><div><p>Remove a security role.</p>
</div><br><h5>Arguments</h5><div class="row param"><div class="col-sm-4"><code>opts</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[opts.roleId]</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">required</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[opts.headers]</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5">optional</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>callback(err)</code></div><div class="col-sm-3"><strong>function</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><br>
</div><br><br><h2>Events</h2><p>Listen for events on an instance of this class.</p><pre><code>respoke.on('event-name', function (arg) {
 
});</code></pre><br><div id="event-connect"><h3><code>event</code> <a href="#event-connect" class="bold">connect</a></h3><div><p>Connected to respoke.</p>
</div><br><br></div><div id="event-disconnect"><h3><code>event</code> <a href="#event-disconnect" class="bold">disconnect</a></h3><div><p>Disconnected from respoke.</p>
</div><br><br></div><div id="event-reconnect"><h3><code>event</code> <a href="#event-reconnect" class="bold">reconnect</a></h3><div><p>Reconnected with respoke.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>num</code></div><div class="col-sm-3"><strong>number</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div><div id="event-reconnecting"><h3><code>event</code> <a href="#event-reconnecting" class="bold">reconnecting</a></h3><div><p>Reconnecting with respoke.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>num</code></div><div class="col-sm-3"><strong>number</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div><div id="event-error"><h3><code>event</code> <a href="#event-error" class="bold">error</a></h3><div><p>An error occurred.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>err</code></div><div class="col-sm-3"><strong>error</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div><div id="event-message"><h3><code>event</code> <a href="#event-message" class="bold">message</a></h3><div><p>There is an incoming private message, from an endpoint.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>msg</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div><div id="event-presence"><h3><code>event</code> <a href="#event-presence" class="bold">presence</a></h3><div><p>Presence for an endpoint has changed or is now available.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>res</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div><div id="event-join"><h3><code>event</code> <a href="#event-join" class="bold">join</a></h3><div><p>An endpoint (which can include this client) has joined a group.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>res</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div><div id="event-leave"><h3><code>event</code> <a href="#event-leave" class="bold">leave</a></h3><div><p>An endpoint (which can include this client) has left a group.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>res</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div><div id="event-pubsub"><h3><code>event</code> <a href="#event-pubsub" class="bold">pubsub</a></h3><div><p>A group message has been received.</p>
</div><br><h4>Callback Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>res</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br></div></div></body></html>